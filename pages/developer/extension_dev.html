---
layout: default
title: Developer Guide
description: AbanteCart Extension’s Developer Guide
tags: [
    ['architecture', 'AbanteCart Architecture']
]
redirect_from: "/tag/extension_dev.html"
---

<div class="category-info helper pt40">
	<h3 class="category-title">AbanteCart Extension’s Developer Guide</h3>
	<h4 class="category-description"> 
	</h4>
	<p>
	The extension subsystem of the AbanteCart is an essential part of shopping cart application. Extensions allow efficient way to add new features to the cart and allow scalability and flexibility of ecommerce application.
The extension subsystem of the AbanteCart allows shopping cart project grow indefinitely together with rapidly changing technologies, standards and techniques.<br>
Lots of effort lays on the development of the system and extensions to allow shopping cart administrators and owners smooth and worry free cart experience.<br>
Extension can be installed and managed in the control panel of AbanteCart. If you use market place to purchase extensions inside the control panel, extensions are downloaded and installed seamlessly without leaving your control panel and web browser. <br>
Our extension architecture is partially based on Plexus API concept (http://code.google.com/p/phpplexus/ ) and blend with our own concepts described below. 
	</p>
</div>

<div class="note js-note blue-light">
	<h4 class="note-title">Document Content</h4>
	<ul>
	<li class="toclevel-1 tocsection-1"><a href="#glossary"> <span class="toctext">Glossary</span></a></li>
	<li class="toclevel-1 tocsection-2"><a href="#basic"> <span class="toctext">Basic architecture and structure of the extension subsystem.</span></a></li>
	<li class="toclevel-1 tocsection-3"><a href="#files"> <span class="toctext">Files and directory structure</span></a></li>
	<li class="toclevel-1 tocsection-4"><a href="#configuration"> <span class="toctext">Extension configuration file</span></a></li>
	<li class="toclevel-1 tocsection-5"><a href="#validation"><span class="toctext">Settings Values Validation</span></a></li>
	<li class="toclevel-1 tocsection-6"><a href="#driver"><span class="toctext">Main driver file for extension</span></a></li>
	<li class="toclevel-1 tocsection-7"><a href="#install"><span class="toctext">Install or Uninstall scripts</span></a></li>
	<li class="toclevel-1 tocsection-8"><a href="#languages"><span class="toctext">Languages</span></a></li>
	<li class="toclevel-1 tocsection-9"><a href="#hooks"><span class="toctext">Hooks</span></a></li>
	<li class="toclevel-1 tocsection-10"><a href="#examples"><span class="toctext">Basic examples</span></a></li>
	<li class="toclevel-1 tocsection-11"><a href="#hooks"><span class="toctext">Hooks Template Variables</span></a></li>
	<li class="toclevel-1 tocsection-12"><a href="#process"><span class="toctext">Extension Process flow</span></a></li>
	<li class="toclevel-1 tocsection-13"><a href="#additional"><span class="toctext">Additional scripts and styles for extensions</span></a></li>
	<li class="toclevel-1 tocsection-14"><a href="#rl"><span class="toctext">Resource Library</span></a></li>
	<li class="toclevel-1 tocsection-15"><a href="#rlexample"><span class="toctext">Example of extension that use resource library</span></a></li>
	<li class="toclevel-1 tocsection-16"><a href="#listingblock"><span class="toctext">Example of extension with listing block wrapper (appearance controller)</span></a></li>
	<li class="toclevel-1 tocsection-17"><a href="#package"><span class="toctext">Package extension for distribution</span></a></li>
	</ul>
</div>




<div class="category-info helper">
	<h4 id="glossary" class="box-title">Glossary</h4>
	<p class="box-description">
<b>Extension</b> &ndash;  Collection of  directories and files under one main directory  that can be added to shopping cart to offer additional feature or function.  Extension can be enabled and configured in the admin of shopping cart application<br>
<b>Extension Configuration</b> &ndash; Collection of settings that can control the extension functionality of behavior.  Configuration can be default (provided with the original installation of the extension) and custom, after installation once admin user change the settings.<br>
<b>Hook</b> &ndash; This is the tool used in extension subsystem to connect extension to particular section in application.<br>
<b>Core Hook</b> &ndash; This is the hook to the core function of application that allows extending functionality, effect data structures and values.
<b>Template Hook</b> -  This is the hook to extend display of the particular page on the front end or admin.  This is usually implemented within template file.<br>
<b>Dataset</b> - Ability to save, access and manage data specific for extension. See more details later on.
</p>
</div>






<div class="category-info helper">
	<h4 id="basic" class="box-title">Basic architecture and structure of the extension subsystem. </h4>
	<p class="box-description">
This paragraph to give you a generic idea about AbanteCart extension system and organization.<br>
AbanteCart architecture is designed around flexibility and expandability in mind. We believe that application architecture should provide sufficient flexibility to be able extended with new features and configured or adjusted to rapidly changing technology. To do so we introduce concept of fully extension based system and empower developers to create extensions for any new features or functionality.<br>
Extension can be installed and managed in the control panel of the AbanteCart. Marketplace is available to purchase, download and install extensions right in the control panel. In addition, any AbanteCart extension can be installed manually by simple upload of extension folder to AbanteCart and easy activation process.<br>
Extension itself is a collection of files that modify or add functionality of AbanteCart. Extension files include installation scripts, configuration settings, extension MVC file.<br>
Dependency concept is present to make sure that dependent extensions are installed to make extensions that depend on them work properly. 
Important stages in extension to understand:<br>
<b>Extension load:</b> This is the step of getting extension directory (content with files) in to the AbanteCart extensions directory. This is essential before step before you can install and use extension.<br>
<b>Extension Installation:</b>  This is a process of loading extension configuration to the system and making extension visible to the system. This stage does dependency validation and error checking. Install script provided in the extension is executed. Note: Installation is not to be confused with downloading extension or loading extension to the directory. This is done prior to installation. This step also allows you to edit extension configuration and settings.<br>
<b>Enable Extension:</b> This is a step to activate extension. Once extension is enabled it will be used by the system.
<b>Uninstall Extension:</b> It is important to understand this step. If you decide no longer to use given extension you can uninstall it. This step will completely remove all the settings and data used by the extension. Uninstall script provided in the extension is executed. Consider backup.<br>
<b>Delete Extension:</b> This is a step to remove extension components from the directory. Note: delete can only be done if extension is uninstalled.
</p>
</div>








<div class="category-info helper">
	<h4 id="files" class="box-title">Files and directory structure </h4>
	<p class="box-description">
All Extensions are located in <b>extensions</b> folder. Bellow is the set of files and directories  that represent one extension.<br></p>
<!-- File Tree -->
<div class="file-tree">
    <div class="file-tree-title"> AbanteCart Directory Structure
    	<ul class="file-tree-buttons">
    		<li class="js-expand">
    			<i class="fa fa-plus"></i> Expand all</li>
    		<li class="js-collapse">
    			<i class="fa fa-minus"></i> Collapse all</li>
    	</ul>
    </div>
    <ul class="file-tree-list js-file-tree" data-expanded="true">
    <li class="is-folder">extensions -
    	<span class="file-tree-description">All Extensions are located in extensions folder. 
    	<a href="https://github.com/abantecart/abantecart-src/tree/master/public_html/extensions" target="_github"><i class="fa fa-code fa-fw"></i></a>
    	</span>
    	<ul>
    	<li class="is-folder">[extension unique name] 
    		<span class="file-tree-description"> </span>
    		<ul>
    			<li class="is-file">config.xml -
    		<span class="file-tree-description">Required configuration xml file with settings for given extension.</span>
    </li>
    <li class="is-file">main.php -
    		<span class="file-tree-description">Required file that contain init instructions for extension.</span>
    </li>
    <li class="is-folder">admin -
    		<span class="file-tree-description">admin directory structure and contain files for admin section (directory structure under this directory resembles main admin directory for AbaneteCart)</span>
    	</li>
    <li class="is-folder">storefront -
    		<span class="file-tree-description">storefront directory structure and contain files for storefront section (directory structure under this directory resembles main storefront directory for AbaneteCart)</span>
    	</li>
    <li class="is-folder">core -
    		<span class="file-tree-description">directory that contain some core addon classes that implement additional functionality ( if needed )</span>
    	</li>
    <li class="is-file">install.sql -
    		<span class="file-tree-description">optional file that contain SQL instructions for extension install</span>
    	</li>
    <li class="is-file">uninstall.sql -
    		<span class="file-tree-description">optional file that contain SQL  instructions for extension uninstall</span>
    	</li>
    <li class="is-file">install.php -
    		<span class="file-tree-description">optional file that contain PHP code for extension installation proces.</span>
    	</li>
    <li class="is-file">uninstall.php -
    		<span class="file-tree-description">optional file that contain PHP code for extension uninstall process</span>
    	</li>
    		</ul>
    	</li>
    	</ul>
    </li>
    </ul>
</div>
						<!-- End of FIle Tree -->

						<div class="note js-note blue">
							<span class="note-close js-close">
								<i class="fa fa-times"></i>
							</span>
							<h4 class="note-title"> Note </h4>
							<p class="note-description"> you can use PHP or SQL or mixed depending on the requirents. </p>
						</div>
						<!-- End of Note -->



<p><img width="650" height="603" src="/img/developer/extensions.png" alt="Directory structure">
</p>

<p><b>Pre-install actions - validation</b><br>
Extensions are installed in control panel from Extension Manager section. Before installation there following checks are performed:
<ul><li> - check available space
</li><li> - is extensions directory writable
</li><li> - was extension already installed ( extension upgrade )
</li><li> - does extension support used core version
</li><li> - does hosting support all php modules used by extension
</li><li> - does extension override some controllers/ template files that already overridden by another extension. if two or more extensions override completely same files there will be a conflict, so high priority extension will be used. But, there will be warning in the install about conflict.
</li></ul></p>


<p><b>Post-install actions</b>
<ul><li> - check all files list and sizes
</li><li> - run install process
</li></ul>
</p>
</div>












<div class="category-info helper">
	<h4 id="configuration" class="box-title">Extension configuration file</h4>
	<p class="box-description">
Most of initial and default settings can be provided in configuration file. This files will be process on extension installation and configuration reset steps.
Bellow is the description of all items that are available in configuration file
</p>

<p><b>config.xml</b> example:
</p>


<!-- HTML Highlight -->
						<div class="code-highlight">
							<span class="js-copy-to-clipboard copy-code">copy</span> <pre><code class="language-markup">
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;extension&gt;
  &lt;id&gt;discount&lt;/id&gt;
  &lt;version&gt;0.1.0&lt;/version&gt;
  &lt;cartversions&gt;
        	&lt;item&gt;1.0&lt;/item&gt;
  &lt;/cartversions&gt;
  &lt;phpmodules&gt;
        	 &lt;item&gt;curl&lt;/item&gt;
  &lt;/phpmodules&gt;
  &lt;layout&gt;&lt;/layout&gt;
  &lt;priority&gt;10&lt;/priority&gt;  
  &lt;type&gt;template&lt;/type&gt;
  &lt;category&gt;template&lt;/category&gt;
  &lt;dependencies&gt;
       &lt;item prior_version=&quot;0.9&quot; version=&quot;1.0&quot;&gt;slideshow&lt;/item&gt;
       &lt;item prior_version=&quot;0.9&quot; version=&quot;1.0&quot;&gt;product_slider&lt;/item&gt;
       &lt;item required=&quot;true&quot; prior_version=&quot;0.9&quot; version=&quot;1.0&quot;&gt;default_cod&lt;/item&gt;
  &lt;/dependencies&gt;
  &lt;settings&gt;
  	&lt;item id=&quot;discount_status&quot;&gt;
  	  	&lt;type&gt;selectbox&lt;/type&gt;
  	  	&lt;default_value&gt;0&lt;/default_value&gt;
  	  	&lt;variants&gt;
            &lt;item&gt;0&lt;/item&gt;
            &lt;item&gt;1&lt;/item&gt;
  	  	&lt;/variants&gt;
  	&lt;/item&gt;
  	&lt;item id=&quot;discount_percent&quot;&gt;
  	  	&lt;type&gt;input&lt;/type&gt;
  	  	&lt;default_value&gt;10&lt;/default_value&gt;
  	&lt;/item&gt;
  	&lt;item id=&quot;discount_message&quot;&gt;
  	  	&lt;type&gt;input&lt;/type&gt;
  	  	&lt;default_value&gt;We are pleased to annouce september discounts&lt;/default_value&gt;
        	&lt;/item&gt;
  	&lt;item id=&quot;discount_product_message&quot;&gt;
  	  	&lt;type&gt;input&lt;/type&gt;
  	  	&lt;default_value&gt;Old price: %s, You save: %s&lt;/default_value&gt;
  	&lt;/item&gt;
&lt;/settings&gt;   
&lt;additional_settings&gt;&lt;![CDATA[setting/setting&amp;active=store]]&gt;&lt;/additional_settings&gt;
&lt;note&gt;true&lt;/note&gt;
&lt;preview&gt;
    &lt;item&gt;preview.jpg&lt;/item&gt;
	&lt;item&gt;preview1.jpg&lt;/item&gt;
  &lt;item&gt;preview2.jpg&lt;/item&gt;
&lt;/preview&gt;
&lt;help_link&gt;&lt;![CDATA[http://google.com]]&gt;&lt;/help_link&gt;
&lt;install&gt;
  	 &lt;sql&gt;install.sql&lt;/sql&gt;
       &lt;trigger&gt;install.php&lt;/trigger&gt;
&lt;/install&gt;
&lt;uninstall&gt;
  	&lt;sql&gt;uninstall.sql&lt;/sql&gt;
  	&lt;trigger&gt;uninstall.php&lt;/trigger&gt;
&lt;/uninstall&gt;
&lt;/extension&gt;

 		</code>
 		</pre>
</div>
<!-- HTML Highlight -->


<p>
<b>More details about each extension config item</b>
</p><p><b>&lt;id&gt;discount&lt;/id&gt;</b> - extension unique named identifier ( should be unique among all other extensions )
</p><p><b>&lt;version&gt;0.1.0&lt;/version&gt;</b> - current extension version
</p><p><b>&lt;cartversions&gt;<br>&lt;item&gt;1.0&lt;/item&gt;<br>&lt;/cartversions&gt;</b>   - supported cart versions by the extension
</p><p><b>&lt;dependencies&gt;...&lt;/dependencies&gt;</b> - if given extension depends on other extension(s) be installed, this item can be used. See examples:
</p><p>Optional extension dependency.  original extension can work without dependant extension installed. ( use only 0.9 - 1.0 versions of extension )
</p>
<!-- HTML Highlight -->
<div class="code-highlight">
	<span class="js-copy-to-clipboard copy-code">copy</span> <pre><code class="language-markup">
&lt;dependencies&gt;
  	&lt;item prior_version=&quot;0.9&quot; version=&quot;1.0&quot;&gt;slideshow&lt;/item&gt; 
&lt;/dependencies&gt;
 	</code>
 	</pre>
</div>
<!-- HTML Highlight -->

<p>
Required extension. Current extension can not work without dependant extension installed.
</p>

<!-- HTML Highlight -->
<div class="code-highlight">
	<span class="js-copy-to-clipboard copy-code">copy</span> <pre><code class="language-markup">
&lt;dependencies&gt;
&lt;item required=&quot;true&quot; prior_version=&quot;0.9&quot; version=&quot;1.0&quot;&gt;default_cod&lt;/item&gt; - extension.
&lt;/dependencies&gt;

&lt;phpmodules&gt; 
  	&lt;item&gt;gd&lt;/item&gt;
&lt;/phpmodules&gt; - Given extension depends on following php modules
 	</code>
 	</pre>
</div>
<!-- HTML Highlight -->



<p><b>&lt;priority&gt;10&lt;/priority&gt;</b> - Extension priority. This will set when current extension needs to be included and ran compare to other extensions installed.<br> 
Higher number will make extension with higher priority. 
</p><p><b>&lt;type&gt;template&lt;/type&gt;</b> - extension type. can be 'extensions', 'payment', 'shipping', 'template'. New types might be added in the future.
</p><p><b>&lt;category&gt;template&lt;/category&gt;</b> - extension category. This mostly used for grouping extensions and not used in AbanteCart itself. 
</p><p><b>&lt;settings&gt;.. &lt;/settings&gt;</b>  - contains extension settings<br>
See allowed settings types below. <br>
Example:
</p>


<!-- HTML Highlight -->
<div class="code-highlight">
	<span class="js-copy-to-clipboard copy-code">copy</span> <pre><code class="language-markup">
 &lt;settings&gt;
       &lt;item id=&quot;discount_status&quot;&gt;
           &lt;type&gt;selectbox&lt;/type&gt;
           &lt;default_value&gt;0&lt;/default_value&gt;
           &lt;variants&gt;
               &lt;item&gt;0&lt;/item&gt;
               &lt;item&gt;1&lt;/item&gt;
           &lt;/variants&gt;
       &lt;/item&gt;
       &lt;item id=&quot;discount_percent&quot;&gt;
           &lt;type&gt;input&lt;/type&gt;
           &lt;default_value&gt;10&lt;/default_value&gt;
       &lt;/item&gt;
  &lt;/settings&gt;
  </code>
 	</pre>
</div>
<!-- HTML Highlight -->


<p>Starting from version 1.1.5 global settings have been implemented.  Now common settings such as status, sort_order etc. are not required to be included. <br> 
If common settings are still included in given extension configuration file, they will override global settings.<br>  
If global setting is not needed, it can be disabled with adding &lt;disabled&gt;true&lt;/disabled&gt;<br> 
Example:
</p>


<!-- HTML Highlight -->
<div class="code-highlight">
	<span class="js-copy-to-clipboard copy-code">copy</span> <pre><code class="language-markup">
		&lt;item id=&quot;payment_minimum_total&quot;&gt;
			&lt;disabled&gt;true&lt;/disabled&gt;
		&lt;/item&gt; 	</code>
 	</pre>
</div>
<!-- HTML Highlight -->

<p>Global settings are located in core/extension/ directory and attached to top or bottom of the settings page. <br> 
Global settings available for any extension (default section) and for extension type as well, such as shipping and payment. <br> 
</p><p><br>
<b>&lt;additional_settings&gt;...&lt;/additional_settings&gt;</b> - you can add link to additional extension settings. It could be controller inside extension or any existing admin controller. By default button title will be ‘Additional Settings’. If you want to change it - you should add language definition with key = ‘text_additional_settings’ to your language file - it will define button title<br>
Example:
</p>


<!-- HTML Highlight -->
<div class="code-highlight">
	<span class="js-copy-to-clipboard copy-code">copy</span> <pre><code class="language-markup">
&lt;additional_settings&gt;&lt;![CDATA[setting/setting&amp;active=store]]&gt;&lt;/additional_settings&gt;</code>
 	</pre>
</div>
<!-- HTML Highlight -->

<p><br>
<b>&lt;note&gt;true&lt;/note&gt;</b> - define if extensions have notes or not. notes defined in language file with key = ‘&lt;extension_name&gt;_note’. note will be shown on extension edit page. This note can help with additional information to users how to manage extension or extra steps to set up extension. 
</p><p><b>&lt;preview&gt;...&lt;/preview&gt;</b> - extension preview images. stored in <i>[extension_id]/image/</i> folder<br>
Example:
</p>
<!-- HTML Highlight -->
<div class="code-highlight">
	<span class="js-copy-to-clipboard copy-code">copy</span> <pre><code class="language-markup">
&lt;preview&gt;
&lt;item&gt;preview.jpg&lt;/item&gt;
&lt;item&gt;preview1.jpg&lt;/item&gt;
&lt;item&gt;preview2.jpg&lt;/item&gt;
&lt;/preview&gt;</code>
 	</pre>
</div>
<!-- HTML Highlight -->
<p><br>
<b>&lt;help_link&gt;&lt;![CDATA<a href="http://www.google.com" class="external autonumber" rel="nofollow">[1]</a>]&gt;&lt;/help_link&gt;</b> - define help page link. if not empty - you will have help button on extension edit page. This can be external link.
</p><p>Install and removal items:
</p>
<!-- HTML Highlight -->
<div class="code-highlight">
	<span class="js-copy-to-clipboard copy-code">copy</span> <pre><code class="language-markup">
&lt;install&gt;
        &lt;sql&gt;install.sql&lt;/sql&gt; - sql queries run on install
       &lt;trigger&gt;install.php&lt;/trigger&gt; - php code run on install
&lt;/install&gt;
&lt;uninstall&gt;
	    	&lt;sql&gt;uninstall.sql&lt;/sql&gt; - sql queries run on uninstall
&lt;trigger&gt;uninstall.php&lt;/trigger&gt; - php code run on uninstall
&lt;/uninstall&gt;</code>
 	</pre>
</div>
<!-- HTML Highlight -->
<p><b>AbanteCart extension support following settings types:</b>
</p>
<ul><li> hidden
</li><li> input
</li><li> password
</li><li> textarea
</li><li> selectbox
</li><li> multiselect
</li><li> checkbox
</li><li> checkbox group
</li><li> file
</li><li> radio
</li></ul>


</div>














